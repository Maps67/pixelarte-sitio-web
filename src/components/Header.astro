---
// src/components/Header.astro (REFACTORIZADO A MOBILE-FIRST)
const pathname = Astro.url.pathname;
---
<header class="header">
    <div class="container">
        <nav class="navigation">
            <a href="/" class="logo-link">
                <img src="/logo-transparente.png" alt="Pixelarte Studio Logo" class="logo-img" />
            </a>

                        <button class="mobile-nav-toggle" aria-controls="primary-navigation" aria-expanded="false">
                <span class="sr-only">Menú</span>
                <svg class="icon-hamburger" aria-hidden="true" focusable="false" width="24" height="24" viewBox="0 0 24 24"><path d="M3 12h18M3 6h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
                <svg class="icon-close" aria-hidden="true" focusable="false" width="24" height="24" viewBox="0 0 24 24"><path d="M6 18L18 6M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
            </button>

                        <div class="nav-wrapper" id="primary-navigation">
                <ul class="nav-links">
                    <li><a href="/" class:list={{ "is-active": pathname === "/" }}>Inicio</a></li>
                    <li><a href="/servicios/" class:list={{ "is-active": pathname === "/servicios/" }}>Servicios</a></li>
                    <li><a href="/portafolio/" class:list={{ "is-active": pathname.startsWith("/portafolio") }}>Casos de Éxito</a></li>
                    <li><a href="/blog/" class:list={{ "is-active": pathname.startsWith("/blog") }}>Blog</a></li>
                    <li><a href="/testimonios/" class:list={{ "is-active": pathname === "/testimonios/" }}>Testimonios</a></li>
                    <li><a href="/proceso/" class:list={{ "is-active": pathname === "/proceso/" }}>Nuestro Sistema</a></li>
                    <li><a href="/aplicar/" class="cta-button">Aplicar para Sesión Estratégica</a></li>
                </ul>
            </div>
        </nav>
    </div>
</header>

<script is:inline>
// Script robustecido para que funcione con la navegación de Astro
function setupMobileNav() {
    const mobileNavToggle = document.querySelector('.mobile-nav-toggle');
    const navWrapper = document.getElementById('primary-navigation');
    if (!mobileNavToggle || !navWrapper) return;

    mobileNavToggle.addEventListener('click', () => {
        const isVisible = navWrapper.getAttribute('data-visible') === 'true';
        if (isVisible) {
            mobileNavToggle.setAttribute('aria-expanded', 'false');
            navWrapper.setAttribute('data-visible', 'false');
        } else {
            mobileNavToggle.setAttribute('aria-expanded', 'true');
            navWrapper.setAttribute('data-visible', 'true');
        }
    });
}
setupMobileNav();
document.addEventListener('astro:page-load', setupMobileNav);
</script>

<style>
/* --- ESTRATEGIA MOBILE-FIRST (Estilos Base = Móvil) --- */
.header { 
  background-color: #ffffff; 
  border-bottom: 1px solid var(--color-borde-claro); 
  padding: 0.5rem 0; 
  position: sticky; 
  top: 0; 
  z-index: 1000; 
  box-shadow: 0 2px 4px rgba(0,0,0,0.05); 
}

/* Usamos el .container global, PERO el header necesita su
  propio padding para que el logo y el botón estén alineados.
*/
.container { 
  max-width: 1200px; 
  margin: 0 auto; 
  padding: 0 1rem; 
}

.navigation { 
  display: flex; 
  justify-content: space-between; 
  align-items: center; 
  height: 60px; 
}

.logo-img { 
  width: 150px; 
  height: auto; 
  z-index: 1001; /* Asegura que esté sobre el menú móvil */
}

/* --- ESTILOS DE MENÚ MÓVIL (Base) --- */
.mobile-nav-toggle { 
  display: block; /* Visible en móvil */
  background: transparent; 
  border: 0; 
  cursor: pointer; 
  padding: 0.5rem; 
  z-index: 1001; 
}
.mobile-nav-toggle .icon-close { display: none; }
.mobile-nav-toggle[aria-expanded="true"] .icon-hamburger { display: none; }
.mobile-nav-toggle[aria-expanded="true"] .icon-close { display: block; }

.nav-wrapper {
  position: fixed; 
  z-index: 999; 
  inset: 0 0 0 30%; /* Menú lateral */
  background-color: rgba(255, 255, 255, 0.9); 
  backdrop-filter: blur(8px); 
  display: flex; 
  flex-direction: column; 
  justify-content: center; 
  align-items: center; 
  transform: translateX(100%); /* Oculto por defecto */
  transition: transform 350ms ease-out; 
}
.nav-wrapper[data-visible="true"] { 
  transform: translateX(0%); 
}

.nav-links { 
  list-style: none; 
  padding: 0; 
  margin: 0;
  display: flex;
  flex-direction: column; /* Vertical en móvil */
  gap: 2.5rem; 
  align-items: center;
}

.nav-links a { 
  text-decoration: none; 
  color: var(--color-texto-secundario); 
  font-weight: 500; 
  transition: color 0.2s ease; 
  white-space: nowrap; 
  font-size: 1.25rem; /* Más grande para táctil */
}

.cta-button {
  font-size: 1rem; /* Resetear tamaño del botón CTA */
}

/* --- ESTILOS DE ESCRITORIO (min-width) --- */
@media (min-width: 1024px) {
  .mobile-nav-toggle {
    display: none; /* Ocultar hamburguesa en desktop */
  }

  .nav-wrapper {
    position: static; /* Resetear a layout normal */
    transform: none; /* Resetear transformación */
    background-color: transparent;
    backdrop-filter: none;
    flex-direction: row; /* Horizontal en desktop */
    justify-content: flex-end;
    padding: 0;
  }

  .nav-links {
    flex-direction: row; /* Horizontal en desktop */
    gap: 1.5rem;
  }

  .nav-links a {
    font-size: 1rem; /* Tamaño de fuente normal en desktop */
  }
  
  .nav-links a:hover { 
    color: var(--color-acento); 
  }

  .nav-links a.is-active { 
    color: var(--color-acento); 
    font-weight: 700; 
  }

  .cta-button { 
    background-color: var(--color-acento); 
    color: #fff !important; 
    border: 1px solid var(--color-acento); 
    padding: 0.5rem 1rem; 
    border-radius: 0.375rem; 
    transition: all 0.2s ease; 
    font-weight: 600; 
  }
  
  .cta-button:hover { 
    background-color: var(--color-acento); 
    color: #fff !important; 
    opacity: 0.9; 
  }
}

.sr-only { 
  position: absolute; 
  width: 1px; 
  height: 1px; 
  padding: 0; 
  margin: -1px; 
  overflow: hidden; 
  clip: rect(0, 0, 0, 0); 
  white-space: nowrap; 
  border: 0; 
}
</style>
