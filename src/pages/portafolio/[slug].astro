---
import Layout from '../../layouts/Layout.astro';

// Esta función es necesaria para las rutas dinámicas en Astro
export async function getStaticPaths() {
    const allProjects = [
        // ===== INICIO DEL CAMBIO: TEXTO OPTIMIZADO =====
        {
            title: 'Sistema Web de Pacientes',
            service: 'Aplicación Web a Medida',
            slug: 'sistema-web-de-pacientes',
            mediaType: 'video',
            problem: 'Un cirujano especialista perdía horas en seguimiento post-operatorio vía WhatsApp, resultando en comunicación desorganizada y una baja adherencia de los pacientes a sus planes de recuperación.',
            solution: 'Diseñamos una aplicación web privada donde cada paciente accede a un portal personalizado con su plan de recuperación. Incluye guías interactivas, recordatorios automáticos de medicamentos y un canal de comunicación directo para resolver dudas puntuales.',
            result: 'Se optimizó en un 70% el tiempo que el doctor dedicaba a tareas administrativas y de seguimiento. Más importante aún, la adherencia de los pacientes al tratamiento mejoró significativamente, acelerando su recuperación y elevando la calidad percibida de la atención.'
        },
        {
            title: 'Tarjeta Digital Médica',
            service: 'Identidad Digital',
            slug: 'tarjeta-digital-medica',
            mediaType: 'image',
            problem: 'Un médico necesitaba proyectar una imagen de vanguardia en congresos y eventos, pero las tarjetas de papel se perdían y no lograban comunicar el valor de su práctica (videos, publicaciones, etc.).',
            solution: 'Creamos una Tarjeta de Presentación Digital accesible vía QR que funciona como un micro-sitio. Centraliza su información de contacto, perfiles en Doctoralia, galería de casos de éxito y botones de acción directa para agendar citas.',
            result: 'La tarjeta se convirtió en su principal herramienta de networking, posicionándolo como un referente tecnológico en su especialidad. La tasa de nuevos contactos generados en eventos aumentó en un 50%.'
        },
        {
            title: 'Tarjeta Digital Corporativa',
            service: 'Herramienta para el Sector Salud',
            slug: 'tarjeta-digital-corporativa',
            mediaType: 'image',
            problem: 'Un equipo de visitadores médicos y representantes de ventas del sector salud necesitaba una forma unificada y moderna de presentarse, compartir fichas técnicas de productos y capturar datos de médicos en campo.',
            solution: 'Desarrollamos una tarjeta digital corporativa que cada representante puede personalizar. Integra catálogos de productos y un formulario de captura de leads que notifica al equipo de ventas en tiempo real, permitiendo un seguimiento inmediato.',
            result: 'Se estandarizó la imagen de la empresa, proyectando innovación. La captura de leads se incrementó en un 25% y se optimizó el ciclo de ventas al tener la información centralizada y disponible al instante.'
        }
        // ===== FIN DEL CAMBIO =====
    ];

    return allProjects.map(project => ({
        params: { slug: project.slug },
        props: { project },
    }));
}

const { project } = Astro.props;

const videoUrl = `/images/${project.slug}.mp4`;
const posterUrl = `/images/${project.slug}-poster.webp`;
const imageUrl = `/images/${project.slug}.webp`;
---

<Layout title={`${project.title} - Caso de Éxito | PixelArte Studio`}>
    <div class="project-detail-page">
        <div class="container">
            
            <header class="project-header">
                <p class="project-service">{project.service}</p>
                <h1 class="project-title">{project.title}</h1>
            </header>

            <div class="project-media">
                {project.mediaType === 'video' ? (
                    <video src={videoUrl} poster={posterUrl} autoplay loop muted playsinline controls />
                ) : (
                    <img src={imageUrl} alt={`Imagen del proyecto ${project.title}`} loading="lazy" />
                )}
            </div>

            <div class="project-narrative">
                <div class="narrative-section">
                    <h2>El Reto</h2>
                    <p>{project.problem}</p>
                </div>
                <div class="narrative-section">
                    <h2>La Solución</h2>
                    <p>{project.solution}</p>
                </div>
                 {/* ===== INICIO DEL CAMBIO: SECCIÓN DE RESULTADOS ===== */}
                <div class="narrative-section">
                    <h2>Resultados Clave</h2>
                    <p>{project.result}</p>
                </div>
                 {/* ===== FIN DEL CAMBIO ===== */}
            </div>

             <div class="back-link-container">
                <a href="/portafolio" class="back-link">&larr; Volver al Portafolio</a>
            </div>

        </div>
    </div>
</Layout>

<style>
    .project-detail-page {
        background-color: var(--color-fondo-oscuro);
        color: var(--color-texto-claro);
        padding: 4rem 0;
    }
    .container {
        max-width: 900px;
        margin: 0 auto;
        padding: 0 1rem;
    }
    .project-header {
        text-align: center;
        margin-bottom: 3rem;
    }
    .project-service {
        color: var(--color-acento);
        font-weight: 600;
        margin-bottom: 0.5rem;
    }
    .project-title {
        font-size: 2.5rem;
        font-weight: 700;
        line-height: 1.2;
    }
    .project-media {
        margin-bottom: 3rem;
        border-radius: 0.5rem;
        overflow: hidden;
        border: 1px solid #334155;
    }
    .project-media img, .project-media video {
        width: 100%;
        height: auto;
        display: block;
    }
    .project-narrative {
        max-width: 750px;
        margin: 0 auto;
    }
    .narrative-section h2 {
        font-size: 1.5rem;
        color: #94a3b8;
        margin-bottom: 1rem;
        border-bottom: 1px solid #334155;
        padding-bottom: 0.5rem;
    }
    .narrative-section p {
        font-size: 1.125rem;
        line-height: 1.8;
        color: #cbd5e1;
        margin-bottom: 2.5rem;
    }
    .back-link-container {
        text-align: center;
        margin-top: 3rem;
    }
    .back-link {
        color: var(--color-acento);
        text-decoration: none;
        font-weight: 600;
    }

    @media (min-width: 768px) {
        .project-detail-page {
            padding: 6rem 0;
        }
        .project-title {
            font-size: 3.5rem;
        }
    }
</style>
