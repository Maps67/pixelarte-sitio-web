---
// src/pages/blog/[slug].astro (VERSIÓN CORREGIDA CON CSS VANILLA)
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
  const allPosts = await getCollection('blog');
  
  return allPosts.map(post => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();

// Función para formatear la fecha
function formatDate(date: Date) {
  return new Date(date).toLocaleDateString('es-ES', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
  });
}
---
<Layout 
  title={post.data.title} 
  description={post.data.description}
  ogImage={post.data.image.url}
  ogImageAlt={post.data.image.alt}
>
  <article class="post-section">
    <div class="container post-container">

      <header class="post-header">
        <h1 class="text-4xl md:text-5xl">
          {post.data.title}
        </h1>
        <p class="post-meta">
          Publicado por {post.data.author} el {formatDate(post.data.pubDate)}
        </p>
      </header>

      <img 
        src={post.data.image.url} 
        alt={post.data.image.alt} 
        width="1200"
        height="630"
        class="post-image"
      />

      <!-- Aquí se renderiza el contenido del Markdown -->
      <div class="prose">
        <Content />
      </div>

      <footer class="post-footer">
        <h2 class="text-2xl md:text-4xl">¿Tu presencia digital está construyendo confianza?</h2>
        <p>Implementa un sistema que te posicione como la autoridad indiscutible.</p>
        <a href="/aplicar/" class="btn-primary">
          Aplica para tu Sesión Estratégica
        </a>
      </footer>

    </div>
  </article>
</Layout>

<!-- 
  ESTILOS PARA LA ESTRUCTURA DE LA PÁGINA (Layout)
  Estos son los estilos que reemplazan a las clases de Tailwind.
-->
<style>
  .post-section {
    padding-top: 4rem;
    padding-bottom: 6rem;
  }
  .post-container {
    max-width: 56rem; /* 896px */
    margin-left: auto;
    margin-right: auto;
  }
  .post-header {
    margin-bottom: 2.5rem; /* 40px */
    text-align: left;
  }
  .post-header h1 {
    font-family: 'Playfair Display', serif;
    margin-bottom: 1rem; /* 16px */
  }
  .post-meta {
    font-size: 1.125rem; /* 18px */
    color: var(--color-texto-secundario);
    line-height: 1.75rem;
  }
  .post-image {
    width: 100%;
    height: auto;
    aspect-ratio: 16 / 9;
    object-fit: cover;
    border-radius: 0.5rem; /* 8px */
    margin-bottom: 2.5rem; /* 40px */
    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.08);
  }
  .post-footer {
    margin-top: 2.5rem; /* 40px */
    padding-top: 2.5rem; /* 40px */
    border-top: 1px solid var(--color-borde-claro);
    text-align: center;
  }
  .post-footer h2 {
    font-family: 'Playfair Display', serif;
    margin-bottom: 1rem; /* 16px */
  }
  .post-footer p {
    font-size: 1.125rem; /* 18px */
    color: var(--color-texto-secundario);
    margin-bottom: 1.5rem; /* 24px */
    max-width: 42rem;
    margin-left: auto;
    margin-right: auto;
  }
</style>

<!-- 
  ESTILOS PARA EL CONTENIDO DEL MARKDOWN (.prose)
  Este bloque es el tuyo original. Lo dejamos tal cual 
  porque es necesario para formatear el <Content />.
-->
<style is:global>
  .prose {
    font-family: 'Inter', sans-serif;
    font-size: 1.125rem;
    line-height: 1.75;
    color: var(--color-texto-oscuro);
  }
  .prose p { margin-bottom: 1.5rem; }
  .prose h2 { font-size: 1.875rem; line-height: 1.3; margin-top: 2.5rem; margin-bottom: 1.5rem; }
  .prose h3 { font-size: 1.5rem; line-height: 1.4; margin-top: 2rem; margin-bottom: 1rem; }
  .prose ul, .prose ol { margin-bottom: 1.5rem; padding-left: 1.75rem; }
  .prose li { margin-bottom: 0.5rem; }
  .prose blockquote { padding-left: 1.5rem; border-left: 4px solid var(--color-acento); font-style: italic; color: var(--color-texto-secundario); margin: 1.5rem 0; }
  .prose a { font-weight: 600; text-decoration: underline; transition: color 0.2s ease; }
  .prose a:hover { color: #1D4ED8; }
  .prose strong { font-weight: 700; }
  .prose img { border-radius: 0.5rem; width: 100%; height: auto; }
</style>
