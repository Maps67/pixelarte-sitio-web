---
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import '@/styles/global.css';

interface Props {
    title: string;
}

const { title } = Astro.props;
---

<!doctype html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="description" content="Pixelarte Studio: Diseño Web con Precisión Digital." />
        <meta name="viewport" content="width=device-width" />
        <meta name="generator" content={Astro.generator} />
        <title>{title}</title>
        
        {/* -- Favicon y Touch Icons Optimizados -- */}
        <link rel="icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
        <link rel="manifest" href="/site.webmanifest" />
        <meta name="msapplication-TileColor" content="#da532c" />
        <meta name="theme-color" content="#ffffff" />
        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css" />
    </head>
    <body>
        <Header />
        <main>
            <slot />
        </main>
        <Footer />

        {/* Librerías Externas */}
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/mcstudios/glightbox/dist/js/glightbox.min.js"></script>

        {/* ✅ INICIO: SCRIPT DE ANIMACIÓN GLOBAL Y OPTIMIZADO */}
        <script>
            document.addEventListener("DOMContentLoaded", () => {
                // Se asegura de que GSAP y ScrollTrigger se hayan cargado antes de usarlos
                if (typeof gsap === 'undefined' || typeof ScrollTrigger === 'undefined') {
                    console.error("GSAP o ScrollTrigger no se cargaron a tiempo.");
                    return;
                }

                gsap.registerPlugin(ScrollTrigger);
            
                // Función genérica para animar elementos si existen en la página
                const animateOnScroll = (selector, stagger = 0) => {
                    const elements = gsap.utils.toArray(selector);
                    if (elements.length > 0) {
                        elements.forEach((el, index) => {
                            gsap.from(el, {
                                y: 50,
                                opacity: 0,
                                duration: 0.8,
                                ease: "power3.out",
                                delay: stagger > 0 ? index * stagger : 0,
                                scrollTrigger: {
                                    trigger: el,
                                    start: "top 85%",
                                    toggleActions: "play none none none"
                                }
                            });
                        });
                    }
                };
            
                // Aplicar animaciones a todos los elementos del sitio
                animateOnScroll('.section-title');
                animateOnScroll('.service-card-v3', 0.1);
                animateOnScroll('.project-card-wrapper', 0.1);
                animateOnScroll('.testimonial-card', 0.1);
                animateOnScroll('.qr-section');
            });
        </script>
        {/* FIN: SCRIPT DE ANIMACIÓN GLOBAL */}
    </body>
</html>



